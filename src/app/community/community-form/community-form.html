<div class="min-h-screen bg-gray-100">
  <!-- Navigation -->
  <nav class="bg-white shadow-sm">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between h-16">
        <div class="flex items-center">
          <h1 class="text-xl font-semibold text-gray-900">
            MUSIC Club - {{ isEditMode ? 'Edit Community' : 'Create Community' }}
          </h1>
        </div>
        <div class="flex items-center space-x-4">
          <button
            (click)="navigateToCommunities()"
            class="text-gray-700 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium"
          >
            All Communities
          </button>
          <button
            (click)="navigateToClub()"
            class="text-gray-700 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium"
          >
            Club
          </button>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="max-w-4xl mx-auto py-6 sm:px-6 lg:px-8">
    <div class="px-4 py-6 sm:px-0">
      <div class="bg-white shadow rounded-lg">
        <div class="px-6 py-4 border-b border-gray-200">
          <h2 class="text-lg font-semibold text-gray-900">{{ isEditMode ? 'Edit Community' : 'Create New Community' }}</h2>
          <p class="text-gray-600 text-sm mt-1">
            {{ isEditMode ? 'Update the community details below' : 'Fill in the details to create a new community' }}
          </p>
        </div>

        <form [formGroup]="communityForm" (ngSubmit)="onSubmit()" class="px-6 py-6 space-y-6">
          <!-- Basic Information -->
          <div>
            <label for="name" class="block text-sm font-medium text-gray-700">Community Name *</label>
            <input
              id="name"
              type="text"
              formControlName="name"
              class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"
              placeholder="e.g., Cybersecurity Community"
            >
            <div *ngIf="communityForm.get('name')?.invalid && communityForm.get('name')?.touched"
                 class="text-red-500 text-xs mt-1">
              Community name is required
            </div>
          </div>

          <div>
            <label for="description" class="block text-sm font-medium text-gray-700">Description *</label>
            <textarea
              id="description"
              formControlName="description"
              rows="4"
              class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"
              placeholder="Describe the community's purpose, activities, and goals..."
            ></textarea>
            <div *ngIf="communityForm.get('description')?.invalid && communityForm.get('description')?.touched"
                 class="text-red-500 text-xs mt-1">
              Description is required
            </div>
          </div>

          <!-- Leadership Positions -->
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div>
              <label for="community_lead" class="block text-sm font-medium text-gray-700">Community Lead ID *</label>
              <input
                id="community_lead"
                type="number"
                formControlName="community_lead"
                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"
                placeholder="User ID"
              >
              <div *ngIf="communityForm.get('community_lead')?.invalid && communityForm.get('community_lead')?.touched"
                   class="text-red-500 text-xs mt-1">
                Community lead ID is required
              </div>
            </div>

            <div>
              <label for="co_lead" class="block text-sm font-medium text-gray-700">Co-Lead ID *</label>
              <input
                id="co_lead"
                type="number"
                formControlName="co_lead"
                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"
                placeholder="User ID"
              >
              <div *ngIf="communityForm.get('co_lead')?.invalid && communityForm.get('co_lead')?.touched"
                   class="text-red-500 text-xs mt-1">
                Co-lead ID is required
              </div>
            </div>

            <div>
              <label for="secretary" class="block text-sm font-medium text-gray-700">Secretary ID *</label>
              <input
                id="secretary"
                type="number"
                formControlName="secretary"
                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"
                placeholder="User ID"
              >
              <div *ngIf="communityForm.get('secretary')?.invalid && communityForm.get('secretary')?.touched"
                   class="text-red-500 text-xs mt-1">
                Secretary ID is required
              </div>
            </div>
          </div>

          <!-- Contact Information -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label for="email" class="block text-sm font-medium text-gray-700">Contact Email *</label>
              <input
                id="email"
                type="email"
                formControlName="email"
                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"
                placeholder="community@example.com"
              >
              <div *ngIf="communityForm.get('email')?.invalid && communityForm.get('email')?.touched"
                   class="text-red-500 text-xs mt-1">
                Valid email is required
              </div>
            </div>

            <div>
              <label for="phone_number" class="block text-sm font-medium text-gray-700">Phone Number</label>
              <input
                id="phone_number"
                type="tel"
                formControlName="phone_number"
                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"
                placeholder="+254..."
              >
            </div>
          </div>

          <!-- Founding Date & Recruitment -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label for="founding_date" class="block text-sm font-medium text-gray-700">Founding Date *</label>
              <input
                id="founding_date"
                type="date"
                formControlName="founding_date"
                class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"
              >
              <div *ngIf="communityForm.get('founding_date')?.invalid && communityForm.get('founding_date')?.touched"
                   class="text-red-500 text-xs mt-1">
                Founding date is required
              </div>
            </div>

            <div class="flex items-center">
              <input
                id="is_recruiting"
                type="checkbox"
                formControlName="is_recruiting"
                class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
              >
              <label for="is_recruiting" class="ml-2 block text-sm text-gray-900">
                Currently recruiting new members
              </label>
            </div>
          </div>

          <!-- Tech Stack -->
          <div>
            <div class="flex justify-between items-center">
              <label class="block text-sm font-medium text-gray-700">Tech Stack</label>
              <button
                type="button"
                (click)="addTechStack()"
                class="text-sm text-blue-600 hover:text-blue-800"
              >
                + Add Technology
              </button>
            </div>
            <div formArrayName="tech_stack" class="mt-2 space-y-2">
              <div *ngFor="let tech of techStack.controls; let i = index" class="flex gap-2">
                <input
                  [formControlName]="i"
                  class="block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"
                  placeholder="Technology name"
                >
                <button
                  type="button"
                  (click)="removeTechStack(i)"
                  class="px-3 py-2 text-red-600 hover:text-red-800"
                >
                  Remove
                </button>
              </div>
            </div>
          </div>

          <!-- Social Media -->
          <div>
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-lg font-medium text-gray-900">Social Media</h3>
              <button
                type="button"
                (click)="addSocialMedia()"
                class="text-sm text-blue-600 hover:text-blue-800"
              >
                + Add Social Media
              </button>
            </div>
            <div formArrayName="social_media" class="space-y-4">
              <div
                *ngFor="let social of socialMedia.controls; let i = index"
                [formGroupName]="i"
                class="border border-gray-200 rounded-lg p-4"
              >
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div>
                    <label [for]="'platform' + i" class="block text-sm font-medium text-gray-700">Platform</label>
                    <input
                      [id]="'platform' + i"
                      type="text"
                      formControlName="platform"
                      class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"
                      placeholder="e.g., LinkedIn, GitHub"
                    >
                  </div>
                  <div>
                    <label [for]="'url' + i" class="block text-sm font-medium text-gray-700">URL</label>
                    <input
                      [id]="'url' + i"
                      type="url"
                      formControlName="url"
                      class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"
                      placeholder="https://..."
                    >
                  </div>
                </div>
                <button
                  type="button"
                  (click)="removeSocialMedia(i)"
                  class="mt-2 text-red-600 hover:text-red-800 text-sm"
                >
                  Remove
                </button>
              </div>
            </div>
          </div>

          <!-- Meeting Sessions -->
          <div>
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-lg font-medium text-gray-900">Meeting Sessions</h3>
              <button
                type="button"
                (click)="addSession()"
                class="text-sm text-blue-600 hover:text-blue-800"
              >
                + Add Session
              </button>
            </div>
            <div formArrayName="sessions" class="space-y-4">
              <div
                *ngFor="let session of sessions.controls; let i = index"
                [formGroupName]="i"
                class="border border-gray-200 rounded-lg p-4"
              >
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                  <div>
                    <label [for]="'day' + i" class="block text-sm font-medium text-gray-700">Day</label>
                    <select
                      [id]="'day' + i"
                      formControlName="day"
                      class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"
                    >
                      <option value="">Select Day</option>
                      <option value="MONDAY">Monday</option>
                      <option value="TUESDAY">Tuesday</option>
                      <option value="WEDNESDAY">Wednesday</option>
                      <option value="THURSDAY">Thursday</option>
                      <option value="FRIDAY">Friday</option>
                      <option value="SATURDAY">Saturday</option>
                      <option value="SUNDAY">Sunday</option>
                    </select>
                  </div>
                  <div>
                    <label [for]="'start_time' + i" class="block text-sm font-medium text-gray-700">Start Time</label>
                    <input
                      [id]="'start_time' + i"
                      type="time"
                      formControlName="start_time"
                      class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"
                    >
                  </div>
                  <div>
                    <label [for]="'end_time' + i" class="block text-sm font-medium text-gray-700">End Time</label>
                    <input
                      [id]="'end_time' + i"
                      type="time"
                      formControlName="end_time"
                      class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"
                    >
                  </div>
                  <div>
                    <label [for]="'meeting_type' + i" class="block text-sm font-medium text-gray-700">Type</label>
                    <select
                      [id]="'meeting_type' + i"
                      formControlName="meeting_type"
                      class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"
                    >
                      <option value="">Select Type</option>
                      <option value="PHYSICAL">Physical</option>
                      <option value="VIRTUAL">Virtual</option>
                    </select>
                  </div>
                </div>
                <div class="mt-4">
                  <label [for]="'location' + i" class="block text-sm font-medium text-gray-700">Location</label>
                  <input
                    [id]="'location' + i"
                    type="text"
                    formControlName="location"
                    class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500"
                    placeholder="e.g., Tech Hub, Room A105 or Zoom"
                  >
                </div>
                <button
                  type="button"
                  (click)="removeSession(i)"
                  class="mt-2 text-red-600 hover:text-red-800 text-sm"
                >
                  Remove Session
                </button>
              </div>
            </div>
          </div>

          <!-- Form Actions -->
          <div class="flex justify-end space-x-3 pt-6">
            <button
              type="button"
              (click)="cancel()"
              class="px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
            >
              Cancel
            </button>
            <button
              type="submit"
              [disabled]="communityForm.invalid || isSubmitting"
              class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"
            >
              {{ isSubmitting ? 'Saving...' : (isEditMode ? 'Update Community' : 'Create Community') }}
            </button>
          </div>

          <!-- Messages -->
          <div *ngIf="errorMessage" class="bg-red-50 border border-red-200 rounded-md p-4">
            <p class="text-red-700 text-sm">{{ errorMessage }}</p>
          </div>

          <div *ngIf="successMessage" class="bg-green-50 border border-green-200 rounded-md p-4">
            <p class="text-green-700 text-sm">{{ successMessage }}</p>
          </div>
        </form>
      </div>
    </div>
  </main>
</div>
